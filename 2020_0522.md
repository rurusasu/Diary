# クオータニオン表現
クオータニオン（四元数）は、
* 航空機
* 宇宙機
* ロボティクス
* 3Dゲーム
* コンピュータグラフィックス
などなど，幅広い分野で活用されているトピック．

## クオータニオンを用いてやりたいこと
大きく分けて以下の2つがある
* 3D空間における「回転」を表す
* 3D物体の「姿勢」を表す

**姿勢**　＝物体がどうゆう無機になっているか\
        　＝物体がどういう**回転**でその向きになったか

回転や姿勢：**最小3個のパラメータで表せる**

クオータニオン：**4個のパラメータで表す**

姿勢は最小3個のパラメータで表されるがクオータニオンは4個のパラメータで表すため姿勢が一意に定まらない（1自由度残ってしまう）．よって，4個のパラメータを縛る制約として「**ノルムが1**」という制約がある．


### 余談「姿勢」と「方向」
「姿勢」は「方向」よりも多くの情報を含んでいる．\
* 方向：「進行方向」や「視線」といったものを表す
* 姿勢：方向 + その方向周りの角度の情報

| |  自由度  | 備考 |
|:---:|:---:|--- |
| 方向 | 2 | 進行方向は3次元ベクトル（3個のパラメータ）で表せるが，そのベクトルの大きさは意味を持たないので1減らして2です|
| 姿勢 | 3 | 方向 + 1 です|

> すなわち，**姿勢は最小3個のパラメータで表せる**


# 1-1. クオータニオンとは
**任意軸回転**が表現できることが強み

## クオータニオンの定義
方向ベクトル$（\lambda_x, \lambda_y, \lambda_z）$を回転軸として，角度 $\theta$ だけ回転する場合，

クオータニオンは，四次元ベクトル$(\lambda_x \sin\frac{\theta}{2}, \lambda_y \sin\frac{\theta}{2}, \lambda_z \sin\frac{\theta}{2}, \cos\frac{\theta}{2})$ で表す．

# 1-2. クオータニオンによる回転操作
三次元ベクトル $\overrightarrow{v}$ や姿勢クオータニオン $p$ に対し，回転 $q$ を実施した結果は以下のように大変シンプルなものになる．

|回転させるもの|回転結果|備考|
| --- | --- | --- |
|ベクトル $\overrightarrow{v}$ | $q \otimes \overrightarrow{v} \otimes \overline{q}$ | $\overline{q}$ は $q$ の逆回転 |
| 姿勢クオータニオン p | $q \otimes p$ ||

演算子の順番は非常に重要で，左右を入れ替えてはダメ．

# 1-3. なぜクオータニオンなのか
三次元空間上で回転や姿勢を表現する代表的な方法として次の3つがある．

|  |パラメータ数|メモリ消費|計算上の扱い易さ|備考|
|---|---|---|---|---|
|クオータニオン|4|〇|◎|バランス型で，その他様々なメリットがある．|
|オイラー角|3|◎|×|具体的な姿勢をイメージしやすく，メモリ的にも優しいが，計算上の難点を抱えている．|
|回転業行列 or DCM|9|×|〇||

オイラー角の二番目の角度が±90度なる場合，**特異点**となって計算上の大きな問題を引き起こすことが知られている．端的に言えば，ヨーとロールの区別ができなくなってしまう状態（[ジンバルロック](https://en.wikipedia.org/wiki/Gimbal_lock)）．


## メリット
* メモリ的にもそこそこ優しい
* 計算時間的にもとても速い
* 回転行列の性質を引き継いでいるので回転の結合計算も容易に行える
* ジンバルロックなどの計算上の問題を引き起こすこともなく
* 計算時に**数値誤差を生じにくく**([この記事](https://docs.microsoft.com/en-us/archive/blogs/ito/963)を参照)
* **回転の連続的変化や補間計算もしやすい**([この記事](https://nyahoon.com/blog/1344/12)を参照)

## デメリット
* クオータニオンが与えられた時に，具体的な回転や姿勢をイメージしにくい


# 1-4. クオータニオンの掛け算
クオータニオン $p = (p_x, p_y, p_z, p_w)$ に対して，回転クオータニオン $q = (q_x, q_y, q_z, q_w)$ を施して得られるクオータニオンは

$$



# YBC-Videoデータセット
# OccludedLINEMODデータセット
# ヒューマンロボットインタラクション
# セマンティックラベル
# 反復最近点アルゴリズム（ICP）
# レンダリング
# テンプレートマッチング
# オブジェクト検出器
# 特徴記述子
# SE変換
# キーポイント検出方法
# Implicit Shape Model
# ハフ投票層
# 非最大抑制
# RoIプーリングレイヤー
