---
marp: true
theme: template
---

参考 [姿勢の表現：オイラー角、単位クォータニオン、および回転ベクトル（2006](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.110.5134)

# 物体の回転

## 1.1. オイラー角

欠点

1. 特異点がある．
1. 姿勢の時間的変化を積分する際に単位四元数よりも精度が低いこと

## 1.2. 四元数

欠点

1. 四元数が直感的な物理的意味を持たないこと
1. 四元数が純粋な回転であるためにはユニティノルムを持たなければならないこと

---

## 1.3. 座標系

![bg right 70%](https://raw.githubusercontent.com/rurusasu/Diary/master/%E7%94%BB%E5%83%8F/2021_0517/fig1.png)

2 つの異なる座標系で表現されたデータの関係を考えます。

- ワールド座標系は、慣性空間に固定されています。
- この座標系の原点を $W$ とする。体固定座標系は、姿勢を表現したい物体に固く固定されており，この座標系の原点を $A$ とする。
- 世界座標系においてその原点 $W$ から体内固定座標系の原点 $A$ の位置ベクトルを $^W\bm{q}_A$ とする．反対に，体内固定座標系の原点 $A$ から世界座標系の原点 $W$ の位置ベクトルを $^A\bm{q}_W$ とする．

---

![bg right 50%](https://raw.githubusercontent.com/rurusasu/Diary/master/%E7%94%BB%E5%83%8F/2021_0517/fig2.png)

世界座標系上のある点 $p$ が世界座標系上の位置 $^W\bm{p}$ に存在するとき，体内固定座標系上では $^A\bm{p}$ で与えられるとする．このとき， $^W\bm{p}$ は世界座標系において以下のように表される．

$$
^W\bm{p} = ^A\bm{p} + ^W\bm{q}_A
$$
一方，A座標系では以下のように表される．
$$
^A\bm{p} = ^A\bm{q}_W + ^W\bm{p}
$$

---

# 2. 回転行列
## 2.1. 2D平面における回転



簡単のために，$^W\bm{q}_A = ^A\bm{q}_W = \bm{0}$ かつ，体内固定座標系が世界座標系に対して $\theta$ だけ回転しているとする．

このとき，体内固定座標系のそれぞれの軸の法線ベクトル $\bm{u}, \bm{v}$ は世界座標系のそれぞれの軸の法線ベクトル $\bm{x}, \bm{y}$ を用いて以下のように与えられる．

$$
\bm{u} = \bm{x} \cos(\theta) + \bm{y} \sin(\theta)
$$
$$
\bm{v} = - \bm{x} \sin(\theta) + \bm{y} \cos(\theta)
$$

---


回転行列 $R$ とは，

> ベクトルとの掛け算で，その長さを保ったままベクトルを回転させる行列のこと．

すべての 3x3 回転行列の特別な直交群を $SO(3)$ と呼び，$R \in SO(3)$ の場合は

$$
\det{R} = \pm 1
$$

$$
R^{-1} = R^T
$$

## 2.1. 座標変換

剛体の姿勢を符号化する回転行列 $R$ を

> 世界座標で表されたベクトルに前置乗算すると、体内固定座標で表された同じベクトルが得られる行列

と定義する。すなわち，$\bm{z} \in \mathbb{R}^3$ を世界座標で表されたベクトルとし，$\bm{z}′ \in \mathbb{R}^3$ を身体固定座標で表された同じベクトルとすると，次のような関係が成り立つ。

$$
\bm{z}' = R \bm{z}
$$

$$
\bm{z} = R^T \bm{z}'
$$

---

![bg right 70%](https://raw.githubusercontent.com/rurusasu/Diary/master/%E7%94%BB%E5%83%8F/2021_0517/fig4.png)

位置ベクトル $\bm{x}_b$ に定義されていた体内座標系に回転行列 $R$ をかけることにより移動されたとする．このとき，この座標系の原点は，世界座標系上において $r\bm{x}_b$ で表され，反対に移動した体内座標系の原点から世界座標系の原点の位置は $R \bm{x}_w'$ で表される．

---

![bg right 70%](https://raw.githubusercontent.com/rurusasu/Diary/master/%E7%94%BB%E5%83%8F/2021_0517/fig5.png)

移動した体内座標系における点 $p'$ の位置 $\bm{x}'$ は，

$$
\bm{x}' = R\bm{x} - R\bm{x}_b = R(\bm{x} - \bm{x}_b)
$$

一方，体内座標系から世界座標系原点への位置ベクトルを $R \bm{x}_w'$ とすると，

$$
\bm{x} = \frac{1}{R} (\bm{x}' - R \bm{x}_w')
$$
