---
marp: true
theme: template
---

# Tnsorflow Eco-system

<dev align="center">
<img src =https://raw.githubusercontent.com/rurusasu/Diary/master/%E7%94%BB%E5%83%8F/TensorFlow_EcoSystem.gif >
</dev>
![Tensorflow Eco-system]()

# 1. 転移学習について
## 1.1. 学習済みの重みを再度使う場合
### 1.1.1. CNNを特徴抽出器として用いる
* CNNの最後の全結合層を取り除き，その他の部分を特徴抽出器として扱う．
* 新しく付けた層だけを学習させ，それ以外の層をフリーズさせておくこともできるが，これでは毎回特徴を抽出し直すことになるため，余計に計算時間がかかる．

### 1.1.2. 畳み込み層を学習し直す
* 学種済みの重みの値を初期値として，ニューラルネットワーク全体を学習し直す．
* ランダムに学習した場合よりも早く学習が収束することが期待できる．

### 1.1.3. 一部の層をフリーズさせておき，それ以外の層だけを学習し直す

---

## 応用例
### 特徴抽出器と分類器とで学習のタイミングをずらす
（仮定）
分類器の最後の全結合層を付け替えた場合，この層は他の層に比べて急速に学習が進むはずである．

よって，
1. 最初は，その全結合層のみで学習を行う．
2. ある程度学習が進むと，すべての層で学習を行う．

### 学習係数を層によって変える
* 取り替えた全結合層は，早く学習が進むように，他の層に比べて学習係数を大きくする．
* それ以外の層は，学習が進んでいるため，小さな学習係数を設定する．

# 学習方法の使い分け
例）
![transfer_table](https://raw.githubusercontent.com/rurusasu/Diary/master/%E7%94%BB%E5%83%8F/transfer_table.png)
※上層→出力層側

## データが少ない・似ている
* データが少ないので，全体を学習し直すと過学習が起きてしまうかもしてない．
* 事前学習にしようしたデータと似ているため，上層の特徴をそのまま使用することができると考えられる．
* 事前学習したCNNを特徴抽出器として使用し，新しく付けた分類器のみで学習するの良い．

## データが多い・似ている
* データが多いため過学習の心配は少ない．
* 上層だけで学習しても良いし，ネットワーク全体で学習することもできる．

## データが少ない・似ていない
* 過学習を防ぐために上層だけを学習させたいが，似ていないデータを使って学習しているため，上層の特徴を使ってもうまく学習できないと考えられる．

**ネットワーク**
上層：口のように特化した特徴を抽出していると考えられる．
下層；エッジなど，より一般的な特徴を抽出していると考えられる．

* ネットワークの途中に分類器を繋ぐとうまくいくかもしれない．

## データが多い・似ていない
* ランダムに初期化された状態から学習することもできるが，事前学習した重みの値を初期値として学習することにより，効率よく学習できることが期待される．